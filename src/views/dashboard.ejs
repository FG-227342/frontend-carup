<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<div class="ps-md-4 pe-md-3 px-2 py-3 page-body">

    <div class="col-12">

        <div class="swiper mySwiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <img style="object-fit: contain;height: 300px;object-position: top;" src="/imgs/bannerDashboard/30anios.png" />
                </div>
                <div class="swiper-slide">
                    <img src="/imgs/bannerDashboard/estamosEnCamino.jpg" />
                </div>
                <div class="swiper-slide">
                    <img style="object-fit: contain;" src="/imgs/bannerDashboard/lideres.jpg" />
                </div>
            </div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
        </div>

    </div>
    <br>

    <div class="card mb-3">
        <div class="card-body">
            <div class="row g-4 li_animate">
                <div class="col-xl-4 col-lg-4">
                    <span class="small">Bienvenid@ nuevamente!</span>
                    <h2 class="fw-bold mb-xl-5 mb-4">Mi Dashboard</h2>
                    <div class="d-flex align-items-start">
                        <img class="avatar lg rounded-circle border border-3" src="/imgs/profile_av.png" alt="avatar">
                        <div class="ms-3">
                            <h4 class="mb-0 text-gradient title-font">Hola, <%=userData[0].userName%>!</h4>
                            <span class="text-muted small"><%=userData[0].userEmail%></span>
                            <p class="mb-0 mt-xl-4 mt-3 text-muted small">"Sección personal de cada usuario"...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row g-3">
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card p-3 px-4">
                <div>Total Servicios</div>
                <div class="py-4 m-0 text-center h2"><span data-purecounter-start="0" data-purecounter-separator=","
                        data-purecounter-currency="" data-purecounter-end="350" class="purecounter">0</span></div>
                <div class="d-flex">
                    <small class="text-muted">Hoy</small>
                    <div class="ms-auto">22%</div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card p-3 px-4">
                <div>Servicios Tomados por mi</div>
                <div class="py-4 m-0 text-center h2"><span data-purecounter-start="0" data-purecounter-separator=","
                        data-purecounter-currency="" data-purecounter-end="23" class="purecounter">0</span></div>
                <div class="d-flex">
                    <small class="text-muted">Hoy</small>
                    <div class="ms-auto">17%</div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card p-3 px-4">
                <div>Cotización Dolar BROU - COMPRA</div>
                <div class="py-4 m-0 text-center h2">
                    <span id="spanDolarCompra"></span>
                </div>
                <div class="d-flex">
                    <small class="text-muted">A día de hoy</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card p-3 px-4">
                <div>Cotización Dolar BROU - VENTA</div>
                <div class="py-4 m-0 text-center h2">
                    <span id="spanDolarVenta"></span>
                </div>
                <div class="d-flex">
                    <small class="text-muted">A día de hoy</small>
                </div>
            </div>
        </div>
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h6 class="card-title">Otros Datos</h6>
                    <div class="dropdown card-action">
                        <a href="#" class="card-fullscreen" title="Ampliar">
                            <svg class="svg-stroke" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M3 16m0 1a1 1 0 0 1 1 -1h3a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-3a1 1 0 0 1 -1 -1z">
                                </path>
                                <path d="M4 12v-6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-6"></path>
                                <path d="M12 8h4v4"></path>
                                <path d="M16 8l-5 5"></path>
                            </svg>
                        </a>
                        <a href="#" class="dropdown-toggle after-none" data-bs-toggle="dropdown" aria-expanded="false"
                            title="Más acciones">
                            <svg class="svg-stroke" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"> </path>
                                <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
                                <path d="M8 12l0 .01"></path>
                                <path d="M12 12l0 .01"></path>
                                <path d="M16 12l0 .01"></path>
                            </svg>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end shadow rounded-4 p-2">
                            <a href="javascript:void(0)" class="dropdown-item rounded-pill"><i
                                    class="me-2 fa fa-share"></i>Share</a>

                            <div class="dropdown-divider"></div>
                            <a href="javascript:void(0)" class="dropdown-item rounded-pill card-options-remove"
                                data-toggle="card-remove"><i class="me-2 fa fa-trash"></i>Delete</a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div id="apex-SalesAnalytics"></div>
                </div>
            </div>
        </div>

    </div>
</div>

<style>
    /*Estilos del slider*/
    .swiper {
        width: 100%;
        height: 300px;
        border-radius: 15px;
    }

    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .swiper-slide img {
        display: block;
        width: 100%;
        height: 500px;
        object-fit: none;

    }
</style>


<script>
  const swiper = new Swiper(".mySwiper", {
        spaceBetween: 30,
        loop: true,
        centeredSlides: true,
        autoplay: {
            delay: 2500,
            disableOnInteraction: false,
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
    });

    swiper.slideNext();
 

    function cargaInicialStorage() {

        (async function cargarPaises() {
            const response = await fetch(urlBackend + "/localidades/paises", { headers: { Authorization: 'Bearer ' + token + '' } });
            const paises = await response.json();
            localStorage.setItem('paises', JSON.stringify(paises));
        })();

        (async function cargarCiudades() {
            const response = await fetch(urlBackend + "/localidades/ciudades", { headers: { Authorization: 'Bearer ' + token + '' } });
            const ciudades = await response.json();
            localStorage.setItem('ciudades', JSON.stringify(ciudades));
        })();


        (async function cargarLocalidades() {
            const response = await fetch(urlBackend + "/localidades/localidades", { headers: { Authorization: 'Bearer ' + token + '' } });
            const localidades = await response.json();
            localStorage.setItem('localidades', JSON.stringify(localidades));
        })();


        (async function cargarZonas() {
            const response = await fetch(urlBackend + "/localidades/zonas", { headers: { Authorization: 'Bearer ' + token + '' } });
            const zonas = await response.json();
            localStorage.setItem('zonas', JSON.stringify(zonas));
        })();

        (async function cargarFallas() {
            const response = await fetch(urlBackend + "/fallas", { headers: { Authorization: 'Bearer ' + token + '' } });
            const fallas = await response.json();
            localStorage.setItem('fallas', JSON.stringify(fallas));
        })();

        (async function cargarMarcas() {
            const response = await fetch(urlBackend + "/marcas", { headers: { Authorization: 'Bearer ' + token + '' } });
            const marcas = await response.json();
            localStorage.setItem('marcas', JSON.stringify(marcas));
        })();

        (async function cargarConcesionarios() {
            const response = await fetch(urlBackend + "/prestadores", { headers: { Authorization: 'Bearer ' + token + '' } });
            const concesionarios = await response.json();
            localStorage.setItem('concesionarios', JSON.stringify(concesionarios));
        })();

        (async function cargarTurno() {
            const response = await fetch(urlBackend + "/turnos/dto", { headers: { Authorization: 'Bearer ' + token + '' } });
            const turno = await response.json();
            localStorage.setItem('turno', JSON.stringify(turno));
        })();

        (async function cargarTiposCliente() {
            const response = await fetch(urlBackend + "/clientes/tipoClientes", { headers: { Authorization: 'Bearer ' + token + '' } });
            const tipos = await response.json();
            localStorage.setItem('tipoCliente', JSON.stringify(tipos));
        })();

        (async function cargarConcesionarios() {
            const response = await fetch(urlBackend + "/choferes", { headers: { Authorization: 'Bearer ' + token + '' } });
            const choferes = await response.json();
            localStorage.setItem('choferes', JSON.stringify(choferes));
        })();
      
    }
    cargaInicialStorage();
    cotizacionBrou();

    async function cotizacionBrou() {
        const response = await fetch("https://cotizaciones-brou-v2-e449.fly.dev/currency/latest");
        const datos = await response.json();
        const compra = datos.rates.USD.buy;
        const venta = datos.rates.USD.sell;
        document.getElementById("spanDolarCompra").innerText = " $ " + compra;
        document.getElementById("spanDolarVenta").innerText = " $ " + venta;
    }
</script>
